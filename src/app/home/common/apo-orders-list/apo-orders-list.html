<div class="main-layout">
    <div class="search-container">
        <mat-form-field appearance="outline">
            <mat-icon matPrefix>search</mat-icon>
            <input matInput (keyup)="applyFilter($event)" placeholder="Search..">
        </mat-form-field>
    </div>

    <div class="table-container">
        <table mat-table [dataSource]="dataSource" matSort matSortActive="orderNo" matSortDisableClear
            matSortDirection="desc">
            <ng-container matColumnDef="#">
                <th mat-header-cell *matHeaderCellDef class="text-align-center">#</th>
                <td mat-cell *matCellDef="let row; let i = index;">
                    {{ i + 1 }}
                </td>
            </ng-container>
            <ng-container matColumnDef="orderNo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-align-center">
                    <span class="header-content">
                        Request ID
                    </span>
                </th>
                <td mat-cell *matCellDef="let row">{{row?.orderNo}}</td>
            </ng-container>

            <ng-container matColumnDef="empName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span class="header-content">
                        Name
                    </span>
                </th>
                <td mat-cell *matCellDef="let row">{{row?.person?.empName}}</td>
            </ng-container>

            <ng-container matColumnDef="service">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>
                    <span class="header-content">
                        Service
                    </span>
                </th>
                <td mat-cell *matCellDef="let row">{{row?.person?.service}}</td>
            </ng-container>

            <ng-container matColumnDef="apoDt">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-align-center">
                    <span class="header-content">
                        APO Date
                    </span>
                </th>
                <td mat-cell *matCellDef="let row">
                    {{row?.apoDt}}
            </ng-container>

            <ng-container matColumnDef="posOrderDt">
                <th mat-header-cell *matHeaderCellDef mat-sort-header disableClear class="text-align-center">
                    <span class="header-content">
                        Posting Date
                    </span>
                </th>
                <td mat-cell *matCellDef="let row">{{row?.posOrderDt}}</td>
            </ng-container>

            <ng-container matColumnDef="joiningDt">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-align-center">
                    <span class="header-content">
                        Joining Date
                    </span>
                </th>
                <td mat-cell *matCellDef="let row">{{row?.joiningDt}}</td>
            </ng-container>

            <ng-container matColumnDef="apoDurtn">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-align-center">
                    <span class="header-content">
                        APO Duration
                    </span>
                </th>
                <td mat-cell *matCellDef="let row" class="text-align-center">{{row?.apoDurtn}}</td>
            </ng-container>

            <ng-container matColumnDef="aging">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-align-center">
                    <span class="header-content">
                        Aging
                    </span>
                </th>
                <td mat-cell *matCellDef="let row" class="text-align-center">
                    {{row?.aging}}</td>
            </ng-container>

            <ng-container matColumnDef="status">
                <th mat-header-cell *matHeaderCellDef mat-sort-header class="text-align-center">
                    <span class="header-content">
                        Status
                    </span>
                </th>
                <td mat-cell *matCellDef="let row" class="text-align-center">
                    <button mat-button class="status-button" (click)="goToAPO(row?.orderNo, row?.status?.statusId)"
                        [ngClass]="getStatusClass(row?.status?.statusId)">
                        <img src="\assets\images\{{row?.status?.statusName|lowercase}}-icon.png">
                        {{ row.status.statusName | titlecase}}
                    </button>
                </td>
            </ng-container>

            <ng-container matColumnDef="action">
                <th mat-header-cell *matHeaderCellDef class="text-align-center">Action</th>
                <td mat-cell *matCellDef="let row" class="text-align-center">
                    <button mat-icon-button (click)="goToAPO(row?.orderNo, row?.status?.statusId)" color="accent"
                        class="circle-button">
                        <img *ngIf="row.status.statusId == enumStatus.DRAFT || row.status.statusId == enumStatus.PENDING"
                            src="\assets\images\edit-icon.png">
                        <img *ngIf="row.status.statusId != enumStatus.DRAFT && row.status.statusId != enumStatus.PENDING"
                            src="\assets\images\view-icon.png">
                    </button>
                    <button
                        *ngIf="(row.status.statusId == enumStatus.DRAFT && this.roleId==enumRole.INITIATOR) || isDelete"
                        mat-icon-button (click)="deleteApoOrder(row.orderNo)" color="accent" class="circle-button">
                        <img src="\assets\images\delete-red-icon.png">
                    </button>
                    <button *ngIf="row.status.statusId != enumStatus.DRAFT && this.roleId==enumRole.INITIATOR"
                        mat-icon-button color="accent" class="circle-button">
                        <img src="\assets\images\delete-white-icon.png">
                    </button>
                </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>
    </div>
    <div>
        <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons
            style="display: flex ; justify-content: center;" aria-label="Select page of periodic elements">
        </mat-paginator>
    </div>
</div>